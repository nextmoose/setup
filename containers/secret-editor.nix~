{ pkgs ? import <nixpkgs> {} }:
with pkgs;
let
  secrets = (import ../custom/secrets/default.nix { inherit pkgs; });
  entrypoint = writeScript "entrypoint.sh" ''
    #!${stdenv.shell}

    ${secrets}/bin/secrets gpg.secret.key
  '';
in
dockerTools.buildImage {
  name = "secret-editor";
  config = {
    Entrypoint = entrypoint;
    Volumes = {
      "/secrets" = {
        "Src" = "/secrets";
	"Foo" = "Bar";
      };
    };
  };
}